# Техническое задание Доктор Веб

Интерактивное in-memory key-value хранилище с поддержкой транзакций

## Описание

Это консольное приложение реализует in-memory key-value хранилище с поддержкой вложенных транзакций. Все команды и сообщения — на русском языке. Данные не сохраняются на диск.

## Основные возможности
- Хранение пар ключ-значение
- Получение, удаление, поиск по значению
- Подсчет количества ключей по значению
- Вложенные транзакции (BEGIN, ROLLBACK, COMMIT)
- Поддержка команды HELP
- Все сообщения и справка — на русском

## Команды

- `SET <ключ> <значение>` — сохранить значение по ключу
- `GET <ключ>` — получить значение по ключу или 'NULL', если не найдено
- `UNSET <ключ>` — удалить ключ
- `COUNTS <значение>` — количество ключей с этим значением
- `FIND <значение>` — все ключи с этим значением
- `BEGIN` — начать транзакцию
- `ROLLBACK` — откатить изменения в текущей транзакции
- `COMMIT` — применить изменения текущей транзакции
- `END` — завершить работу приложения
- `HELP` — показать справку по командам

## Пример использования
```
SET a 10
GET a
BEGIN
SET a 20
GET a
ROLLBACK
GET a
END
```

## Установка и запуск

### Poetry
1. Установите Poetry: https://python-poetry.org/docs/#installation
2. Установите зависимости:
   ```
   poetry install
   ```
3. Запустите приложение:
   ```
   poetry run python main.py
   ```

### Docker
1. Соберите образ:
   ```
   docker build -t kvstore .
   ```
2. Запустите контейнер:
   ```
   docker run -it kvstore
   ```

### Makefile
- `make run` — запуск приложения
- `make test` — запуск тестов
- `make lint` — автоформатирование кода
- `make build` — сборка Docker-образа
- `make run-docker` — сборка образа и запуск контейнера в интерактивном режиме
- `make clean` — очистка временных файлов

## Тестирование

Для запуска тестов используйте:
```
make test
```
или
```
poetry run pytest
```

## Архитектура

- `main.py` — точка входа, CLI-логика
- `utils/key_value_store.py` — логика key-value хранилища и транзакций
- `utils/command_dispatcher.py` — обработка команд
- `utils/read_command.py` — чтение и парсинг команд
- `utils/logger_config.py` — настройка логгера
- `tests/` — тесты на pytest

## Требования
- Python 3.10+
- Poetry
- Docker (опционально)
